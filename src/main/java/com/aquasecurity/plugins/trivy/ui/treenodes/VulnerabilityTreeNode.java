package com.aquasecurity.plugins.trivy.ui.treenodes;


import com.aquasecurity.plugins.trivy.icons.TrivyIcons;
import com.aquasecurity.plugins.trivy.model.Location;
import com.aquasecurity.plugins.trivy.model.Vulnerability;

import javax.swing.*;
import javax.swing.tree.DefaultMutableTreeNode;

public class VulnerabilityTreeNode extends DefaultMutableTreeNode implements TrivyTreeNode {


    private final String filepath;
    private final Vulnerability vulnerability;


    public VulnerabilityTreeNode(Vulnerability vulnerability, String filepath) {
        this.filepath = filepath;
        this.vulnerability = vulnerability;
    }

    @Override
    public Icon getIcon() {
        return TrivyIcons.Trivy;
    }

    @Override
    public String getTitle() {
        return this.vulnerability.vulnerabilityID;
    }

    @Override
    public String getTooltip() {
        return "";
    }


    public Location getLocation() {
        return new Location(filepath, 1, 1);
    }

    public Vulnerability getVulnerability() {
        return vulnerability;
    }
}
